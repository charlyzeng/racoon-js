!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).racoon={})}(this,(function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t,e,r){return(c=a()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&o(i,r.prototype),i}).apply(null,arguments)}function s(t){var e="function"==typeof Map?new Map:void 0;return(s=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return c(t,arguments,u(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,t)})(t)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e=a();return function(){var r,n=u(t);if(e){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function f(t,e,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function v(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var p=Object.prototype.toString;function d(t){var e=p.call(t);return e.substring(8,e.length-1)}function g(t){return"Undefined"===d(t)}function w(t){return null===t}function b(t){return t!=t}function m(t){return g(t)||w(t)}function k(t){var e=d(t);return"Object"===e?0===Object.keys(t).length:"Array"===e||"Arguments"===e?0===t.length:function(t){return!t}(t)}function R(t){return"number"==typeof t}function E(t){return"Object"===d(t)}function x(t){return"Function"===d(t)}function j(t){for(var e=/^[_$a-z][_$a-z\d]*$/i,r="",n=0;n<t.length;n+=1){var i=t[n],u=i.type,o=i.key;"prop"===u&&e.test(o)?r+=r?".".concat(o):o:"prop"===u?r+="['".concat(o,"']"):"index"===u&&(r+="[".concat(o,"]"))}return r}var O={number:"number",string:"string",boolean:"boolean",object:"object",array:"array",any:"any"},A=function(t){i(o,t);var r=h(o);function o(){return e(this,o),r.apply(this,arguments)}return n(o,[{key:"toString",value:function(){return"Validate".concat(f(u(o.prototype),"toString",this).call(this))}}]),o}(s(Error)),q=function(){function t(){e(this,t),this.errorConfig={message:"",ctx:null}}return n(t,[{key:"setErrorMessage",value:function(t,e){this.errorConfig={message:t,ctx:e}}},{key:"getError",value:function(t){var e=this.errorConfig,r=e.message,n=e.ctx;return x(r)?new A(r.call(n,t)):new A(r||t)}}]),t}(),S=function(t){i(u,t);var r=h(u);function u(){var t;e(this,u);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=r.call.apply(r,[this].concat(i))).isAllowNaN=!1,t.isAllowInfinity=!1,t}return n(u,[{key:"enableAllowNaN",value:function(){this.isAllowNaN=!0}},{key:"enableAllowInfinity",value:function(){this.isAllowInfinity=!0}},{key:"validate",value:function(t){var e=this.isAllowNaN,r=this.isAllowInfinity;if(b(t)&&!1===e)throw this.getError("value is not allowed to be NaN");if(function(t){return R(t)&&!1===b(t)&&!1===Number.isFinite(t)}(t)&&!1===r)throw this.getError("value is not allowed to be Infinity");if(R(t)||g(t)||w(t))return!0;throw this.getError("value should be typeof number")}}]),u}(q),V=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(m(t))throw this.getError("value is required and should not be undefined/null");if(b(t))throw this.getError("value is required and should not be NaN");return!0}}]),u}(q),N=function(t){i(u,t);var r=h(u);function u(){var t;e(this,u),(t=r.call(this)).enumValues=null;for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];if(0===i.length)throw new RangeError("enum arguments can not be empty");return t.enumValues=i,t}return n(u,[{key:"validate",value:function(t){if(this.enumValues.indexOf(t)>-1)return!0;throw this.getError("value should be one of ".concat(this.valueStr))}},{key:"valueStr",get:function(){return JSON.stringify(this.enumValues)}}]),u}(q),C=function(t){i(u,t);var r=h(u);function u(t,n){var i;if(e(this,u),i=r.call(this),!1===R(t))throw new TypeError("`max` should be typeof number");return i.max=t,i.closed=!1!==n,i}return n(u,[{key:"validate",value:function(t){if(!1===this.closed){if(t<this.max)return!0;throw this.getError("value should less than ".concat(this.max))}if(t<=this.max)return!0;throw this.getError("value should less than or equal ".concat(this.max))}}]),u}(q),T=function(t){i(u,t);var r=h(u);function u(t,n){var i;if(e(this,u),i=r.call(this),!1===R(t))throw new TypeError("`min` should be a number");return i.min=t,i.closed=!1!==n,i}return n(u,[{key:"validate",value:function(t){if(!1===this.closed){if(t>this.min)return!0;throw this.getError("value should greater than ".concat(this.min))}if(t>=this.min)return!0;throw this.getError("value should greater than or equal ".concat(this.min))}}]),u}(q),_=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(function(t){return!1!==R(t)&&Math.floor(t)===t}(t))return!0;throw this.getError("value should be an int")}}]),u}(q),I=function(t){i(u,t);var r=h(u);function u(t){var n;return e(this,u),(n=r.call(this)).strict=!1,n.strict=!0===t,n}return n(u,[{key:"validate",value:function(t){if(!0===this.strict){if(k(t))throw this.getError("value is required and should not be empty");return!0}if(m(t))throw this.getError("value is required and should not be undefined/null");return!0}}]),u}(q),U=function(t){i(u,t);var r=h(u);function u(t,n){var i;if(e(this,u),i=r.call(this),!1===x(t))throw new TypeError("`custom` must receive a Function parameter");return i.restrictFn=t,i.ctx=n,i}return n(u,[{key:"validate",value:function(t){try{this.restrictFn.call(this.ctx,t)}catch(t){throw this.getError(t.message)}return!0}}]),u}(q),P=function(){function t(){e(this,t),this.restricts=[],this.typeRestrict=null,this.requiredRestrict=null,this.currentRestrict=null,this.defaultConfig={enable:!1,strict:!1,value:void 0},this.formatterConfig={ctx:void 0,formatter:function(t){return t}}}return n(t,[{key:"required",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.requiredRestrict=new I(t),this.currentRestrict=this.requiredRestrict,this}},{key:"custom",value:function(t,e){var r=new U(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"error",value:function(t,e){return this.currentRestrict.setErrorMessage(t,e),this}},{key:"default",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(0===e.length)throw new Error("`default` args can not be empty");var n=e[0],i=e[1],u=e[2];return Object.assign(this.defaultConfig,{enable:!0,strict:!0===i,value:n,ctx:u}),this}},{key:"format",value:function(t,e){if("function"!=typeof t)throw new TypeError("`format` argument should be a function");return this.formatterConfig={ctx:e,formatter:t},this}},{key:"calcDefaultValue",value:function(t){var e=this.defaultConfig,r=e.value,n=e.ctx;return"function"==typeof r?r.call(n,t):r}},{key:"getReturnValueWithStrict",value:function(t){var e=this.defaultConfig,r=e.enable,n=e.strict,i=this.formatterConfig,u=i.formatter,o=i.ctx;return r&&(m(t)||b(t))||r&&k(t)&&n?u.call(o,this.calcDefaultValue(t)):u.call(o,t)}},{key:"getReturnValue",value:function(t){var e=this.formatterConfig,r=e.formatter,n=e.ctx;return this.defaultConfig.enable&&(m(t)||b(t))?r.call(n,this.calcDefaultValue(t)):r.call(n,t)}},{key:"checkType",value:function(t){return this.typeRestrict.validate(t)}},{key:"checkRequired",value:function(t){return!this.requiredRestrict||this.requiredRestrict.validate(t)}},{key:"checkRestricts",value:function(t){for(var e=0;e<this.restricts.length;e+=1)this.restricts[e].validate(t);return!0}},{key:"validate",value:function(t){return!this.requiredRestrict&&m(t)||(this.checkType(t),this.checkRequired(t),this.checkRestricts(t)),this.getReturnValue(t)}},{key:"validateSilent",value:function(t){try{return{value:this.validate(t)}}catch(e){return{error:e,value:t}}}}]),t}(),D=function(t){i(u,t);var r=h(u);function u(){var t;return e(this,u),(t=r.call(this)).type=O.number,t.typeRestrict=new S,t.currentRestrict=t.typeRestrict,t}return n(u,[{key:"getReturnValue",value:function(t){var e=this.defaultConfig.enable,r=this.formatterConfig,n=r.formatter,i=r.ctx;return e&&(m(t)||b(t))?n.call(i,this.calcDefaultValue(t)):n.call(i,t)}},{key:"default",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(0===e.length)throw new Error("`default` args can not be empty");var n=e[0],i=e[1];return Object.assign(this.defaultConfig,{enable:!0,strict:!1,value:n,ctx:i}),this}},{key:"enum",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=c(N,e);return this.restricts.push(n),this.currentRestrict=n,this}},{key:"required",value:function(){return this.requiredRestrict=new V,this.currentRestrict=this.requiredRestrict,this}},{key:"allowNaN",value:function(){return this.typeRestrict.enableAllowNaN(),this}},{key:"allowInfinity",value:function(){return this.typeRestrict.enableAllowInfinity(),this}},{key:"min",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new T(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"max",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new C(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"int",value:function(){var t=new _;return this.restricts.push(t),this.currentRestrict=t,this}}]),u}(P),F=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(function(t){return"string"==typeof t}(t)||m(t))return!0;throw this.getError("value should be typeof string")}}]),u}(q),M=function(t){i(u,t);var r=h(u);function u(t,n){var i;if(e(this,u),i=r.call(this),!1===R(t))throw new TypeError("`max` should be typeof number");return i.max=t,i.closed=!1!==n,i}return n(u,[{key:"validate",value:function(t){if(this.closed){if(t.length<=this.max)return!0;throw this.getError("value length should less than or equal ".concat(this.max))}if(t.length<this.max)return!0;throw this.getError("value length should less than ".concat(this.max))}}]),u}(q),W=function(t){i(u,t);var r=h(u);function u(t,n){var i;if(e(this,u),i=r.call(this),!1===R(t))throw new TypeError("`min` should be a number");return i.min=t,i.closed=!1!==n,i}return n(u,[{key:"validate",value:function(t){if(this.closed){if(t.length>=this.min)return!0;throw this.getError("value length should greater than or equal ".concat(this.min))}if(t.length>this.min)return!0;throw this.getError("value length should greater than ".concat(this.min))}}]),u}(q),$=function(t){i(u,t);var r=h(u);function u(t){var n;if(e(this,u),n=r.call(this),!1==t instanceof RegExp)throw new TypeError("pattern should be a RegExp");return n.pattern=t,n}return n(u,[{key:"validate",value:function(t){if(this.pattern.test(t))return!0;throw this.getError("value should match pattern ".concat(this.pattern.toString()))}}]),u}(q),z=function(t){i(u,t);var r=h(u);function u(){var t;return e(this,u),(t=r.call(this)).type=O.string,t.typeRestrict=new F,t.currentRestrict=t.typeRestrict,t}return n(u,[{key:"getReturnValue",value:function(t){return this.getReturnValueWithStrict(t)}},{key:"enum",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=c(N,e);return this.restricts.push(n),this.currentRestrict=n,this}},{key:"max",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new M(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"min",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new W(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"pattern",value:function(t){var e=new $(t);return this.restricts.push(e),this.currentRestrict=e,this}}]),u}(P),K=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(function(t){return"boolean"==typeof t}(t)||m(t))return!0;throw this.getError("value should be typeof boolean")}}]),u}(q),J=function(t){i(u,t);var r=h(u);function u(){var t;return e(this,u),(t=r.call(this)).type=O,t.typeRestrict=new K,t.currentRestrict=t.typeRestrict,t}return n(u,[{key:"enum",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=c(N,e);return this.restricts.push(n),this.currentRestrict=n,this}},{key:"default",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(0===e.length)throw new Error("`default` args can not be empty");var n=e[0],i=e[1];return Object.assign(this.defaultConfig,{enable:!0,strict:!1,value:n,ctx:i}),this}}]),u}(P),B=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){return!0}}]),u}(q),G=function(t){i(u,t);var r=h(u);function u(t){var n;return e(this,u),(n=r.call(this)).strict=!1,n.strict=!0===t,n}return n(u,[{key:"validate",value:function(t){if(!0===this.strict){if(m(t)||""===t||b(t)||function(t){return"Object"===d(t)&&0===Object.keys(t).length}(t)||function(t){return"Array"===d(t)&&0===t.length}(t))throw this.getError("value is required and should not be empty");return!0}if(m(t)||b(t))throw this.getError("value is required and should not be undefined/null/NaN");return!0}}]),u}(q),H=function(t){i(u,t);var r=h(u);function u(){var t;return e(this,u),(t=r.call(this)).type=O.any,t.typeRestrict=new B,t.currentRestrict=t.typeRestrict,t}return n(u,[{key:"getReturnValue",value:function(t){return this.getReturnValueWithStrict(t)}},{key:"required",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.requiredRestrict=new G(t),this.currentRestrict=this.requiredRestrict,this}},{key:"enum",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=c(N,e);return this.restricts.push(n),this.currentRestrict=n,this}}]),u}(P),L=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(E(t)||g(t)||w(t))return!0;throw this.getError("value should be typeof object")}}]),u}(q),Q=function(t){i(u,t);var r=h(u);function u(t){var n;if(e(this,u),(n=r.call(this)).type=O.object,n.config=null,n.isStripUnknown=!1,n.isAllowUnknown=!1,n.typeRestrict=new L,n.currentRestrict=n.typeRestrict,E(t)){var i=Object.create(null);Object.keys(t).forEach((function(e){t[e]instanceof P&&(i[e]=t[e])})),n.config=i}return n}return n(u,[{key:"hasKey",value:function(t){return this.keys.includes(t)}},{key:"getReturnValue",value:function(t){return this.getReturnValueWithStrict(t)}},{key:"stripUnknown",value:function(){return this.isStripUnknown=!0,this}},{key:"allowUnknown",value:function(){return this.isAllowUnknown=!0,this}},{key:"validateRecurse",value:function(t,e){if(e=e||[],null===this.config)return t;var r,n={};r=!0===this.isStripUnknown?this.keys:Object.keys(t);for(var i=0;i<r.length;i+=1){var u=r[i],o=this.config[u];if(!1===this.hasKey(u)){if(!0===this.isAllowUnknown){n[u]=t[u];continue}throw new A("the key `".concat(u,"` is not allowed"))}try{o.type===O.object||o.type===O.array?n[u]=o.validateRecurse(t[u],[].concat(v(e),[{key:u,type:"prop"}])):n[u]=o.validate(t[u])}catch(t){if(t instanceof A){var a=j([].concat(v(e),[{type:"prop",key:u}]));throw a='"'.concat(a,'": '),new Error("".concat(a).concat(t.message))}throw t}}return n}},{key:"validate",value:function(t){return!this.requiredRestrict&&m(t)?this.getReturnValue(t):(this.checkRequired(t),this.checkType(t),this.checkRestricts(t),this.getReturnValue(this.validateRecurse(t)))}},{key:"keys",get:function(){return Object.keys(this.config)}}]),u}(P),X=function(t){i(u,t);var r=h(u);function u(){return e(this,u),r.apply(this,arguments)}return n(u,[{key:"validate",value:function(t){if(function(t){return Array.isArray(t)}(t)||g(t)||w(t))return!0;throw this.getError("value should be typeof array")}}]),u}(q),Y=function(t){i(u,t);var r=h(u);function u(t){var n;return e(this,u),(n=r.call(this)).type=O.array,n.itemSchema=null,n.typeRestrict=new X,n.currentRestrict=n.typeRestrict,t instanceof P&&(n.itemSchema=t),n}return n(u,[{key:"getReturnValue",value:function(t){return this.getReturnValueWithStrict(t)}},{key:"min",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new W(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"max",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new M(t,e);return this.restricts.push(r),this.currentRestrict=r,this}},{key:"validateRecurse",value:function(t,e){e=e||[];var r=this.itemSchema;if(r){for(var n=[],i=0;i<t.length;i+=1)try{r.type===O.array||r.type===O.object?n.push(r.validateRecurse(t[i],[].concat(v(e),[{type:"index",key:i}]))):n.push(r.validate(t[i]))}catch(t){if(t instanceof A){var u=j([].concat(v(e),[{type:"index",key:i}]));throw u='"'.concat(u,'": '),new Error("".concat(u).concat(t.message))}throw t}return n}return t}},{key:"validate",value:function(t){return!this.requiredRestrict&&m(t)?this.getReturnValue(t):(this.checkRequired(t),this.checkType(t),this.checkRestricts(t),this.getReturnValue(this.validateRecurse(t)))}}]),u}(P);function Z(){return new D}function tt(){return new z}function et(){return new J}function rt(){return new H}function nt(t){return new Q(t)}function it(t){return new Y(t)}var ut={number:Z,string:tt,boolean:et,any:rt,object:nt,array:it};t.any=rt,t.array=it,t.boolean=et,t.default=ut,t.number=Z,t.object=nt,t.string=tt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=racoon.min.js.map
